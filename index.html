<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Raport Kredytowy</title>

  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icon-192.png" sizes="192x192" type="image/png" />
  <meta name="theme-color" content="#0b1220" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="color-scheme" content="dark light" />

  <style>
    body {
      background: #121416;
      color: #e2e6e9;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      margin: 0;
      padding: 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid #334158;
      border-radius: 10px;
      margin-bottom: 1rem;
      background: #1f2937;
      color: #e2e6e9;
      overflow: hidden;
    }
    th, td {
      padding: 12px 16px;
      border: 1px solid #334158;
      text-align: left;
      vertical-align: middle;
      font-size: 14px;
    }
    th {
      font-weight: 600;
      background: #111827;
      color: #f8f9fa;
    }
    .value.up { color: #e65050; font-weight: 600; }
    .value.down { color: #40c09e; font-weight: 600; }
    section { margin: 20px 0; }
    h2 { color: #52b0ff; margin-bottom: 10px; }
  </style>

  <!-- Chart.js (przypiƒôta wersja) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- Konfiguracja aplikacji -->
  <script>
    window.APP_VERSION = 'v3.5.1';
    window.RAPORT_ENDPOINT = 'https://script.google.com/macros/s/AKfycbymwnWurFrti71e3PDkm658dfRswPE-OFjTGKs24TdxYi2aS2btOPTm2Hb5xsOLe4II9w/exec?path=/api/report/json';

    function getCSS(property) {
      return getComputedStyle(document.documentElement).getPropertyValue(property) || '#ffffff';
    }
  </script>
</head>
<body>

<div id="app">
  <header style="padding: 1rem; background-color: #0b1220; color: #52b0ff; text-align: center;">
    <h1>üìä Raport Kredytowy</h1>
    <div id="asOf">≈Åadowanie...</div>
  </header>

  <main style="padding: 1rem;">
    <!-- Podstawowe dane kredytowe -->
    <section>
      <h2>üí∞ Dane kredytowe</h2>
      <div>WIBOR 3M: <span id="wibor">‚Äì</span></div>
      <div>Bie≈ºƒÖca rata: <span id="curr">‚Äì</span></div>
      <div>Szacowana nowa rata: <span id="new">‚Äì</span></div>
      <div>R√≥≈ºnica: <span id="diff">‚Äì</span></div>
      <div>Pozosta≈Ço rat: <span id="raty">‚Äì</span> <small id="ratySub"></small></div>
    </section>

    <!-- Postƒôp sp≈Çaty -->
    <section>
      <h2>üìà Postƒôp sp≈Çaty</h2>
      <div><strong>Kapita≈Ç poczƒÖtkowy:</strong> <span id="init">‚Äì</span></div>
      <div><strong>Kapita≈Ç sp≈Çacony:</strong> <span id="paid">‚Äì</span></div>
      <div><strong>Pozosta≈Ço do sp≈Çaty:</strong> <span id="rem">‚Äì</span></div>
      <div style="background-color: #333; border-radius: 12px; margin: 10px 0; padding: 2px; height: 28px;">
        <div id="bar" style="height: 24px; background: linear-gradient(90deg, #0066cc, #52b0ff); border-radius: 10px; width: 0%; transition: width 1s; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
          <span id="barLabel">0%</span>
        </div>
      </div>
      <div>Sp≈Çacono: <span id="pct">‚Äì</span></div>
    </section>

    <!-- Struktura raty -->
    <section>
      <h2>ü•ß Struktura najbli≈ºszej raty</h2>
      <div style="text-align: center;">
        <canvas id="pieChart" width="250" height="250" style="display: block; margin: 1rem auto; background-color: transparent; border-radius: 12px;"></canvas>
        <div style="display: flex; justify-content: center; gap: 2rem; margin-top: 10px;">
          <div>
            <span style="background: #3b82f6; padding: 4px 12px; border-radius: 8px; display: inline-block; margin-right: 8px;"></span>
            Odsetki: <span id="odsetki">‚Äì</span>
          </div>
          <div>
            <span style="background: #93c5fd; padding: 4px 12px; border-radius: 8px; display: inline-block; margin-right: 8px;"></span>
            Kapita≈Ç: <span id="kapital">‚Äì</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Historia WIBOR 3M (wykres + tabela) -->
    <section>
      <h2>üìä Historia WIBOR 3M</h2>
      <div style="background:#1f2937;border:1px solid #334158;border-radius:12px;padding:12px;margin-bottom:12px;">
        <canvas id="wiborChart" style="display:block;width:100%;height:auto;max-width:460px;margin:0 auto;"></canvas>
      </div>
      <div id="histWrap">
        <div id="histTableWrap"></div>
      </div>
    </section>

    <!-- Prognozy FRA (wykres + tabela) -->
    <section>
      <h2>üîÆ Prognozy FRA</h2>
      <div style="background:#1f2937;border:1px solid #334158;border-radius:12px;padding:12px;margin-bottom:12px;">
        <canvas id="fraChart" style="display:block;width:100%;height:auto;max-width:460px;margin:0 auto;"></canvas>
      </div>
      <div id="fraTableWrap"></div>
    </section>
  </main>

  <!-- Box na b≈Çƒôdy + retry -->
  <div id="errorBox" style="color:#ff6b6b;background-color:#2d1b1b;padding:15px;text-align:center;display:none;margin:20px;border-radius:8px;border:1px solid #ff6b6b;"></div>
  <div style="text-align:center;margin:20px;">
    <button id="retryBtn" style="display:none;padding:12px 24px;background-color:#52b0ff;border:none;color:#fff;border-radius:8px;font-weight:600;cursor:pointer;font-size:16px;">
      üîÑ Spr√≥buj ponownie
    </button>
  </div>
</div>

<!-- Logika aplikacji (wersjonowana, by ominƒÖƒá cache) -->
<script src="./app.js?v=v3.5.0"></script>
</body>
</html>
