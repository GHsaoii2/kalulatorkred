// app.js (v3.5.2) — akordeon + lazy render sekcji

function getCSS(property) {
  return getComputedStyle(document.documentElement).getPropertyValue(property) || '#ffffff';
}

(function () {
  const id = (s) => document.getElementById(s);
  const NBSP = "\u00A0";
  const PLN = (v) => (v == null ? "-" : Number(v).toFixed(2) + NBSP + "zł");
  const monthsPL = ["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"];

  // ostatnie dane i statusy renderów sekcji
  let LAST_DATA = null;
  const RENDERED = { progress:false, pie:false, wibor:false, fra:false };

  // Rejestr wykresów (by unikać dublowania)
  const CHARTS = {};
  function makeChart(canvasId, config) {
    const cvs = document.getElementById(canvasId);
    if (!cvs) return null;
    try {
      if (CHARTS[canvasId]) CHARTS[canvasId].destroy();
      CHARTS[canvasId] = new Chart(cvs, config);
      return CHARTS[canvasId];
    } catch (e) {
      console.warn("Chart error for", canvasId, e);
      return null;
    }
  }

  function ratyWord(n) {
    n = Math.abs(Math.floor(n || 0));
    const last = n % 10, last2 = n % 100;
    if (n === 1) return "rata";
    if (last >= 2 && last <= 4 && !(last2 >= 12 && last2 <= 14)) return "raty";
    return "rat";
  }

  function abortableFetch(url, ms = 12000)
